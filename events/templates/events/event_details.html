{% extends "base.html" %}
{% load i18n imagekit %}

{% block title %}
    {{ event.name }}
{% endblock %}

{% block content %}
    {% if event.get_logo %}
        {% thumbnail '100x100' event.get_logo -- class="thumbnail" %}
    {% endif %}
    {% if change_logo_form %}
        <form class="change-event-logo-form autosubmit" enctype="multipart/form-data" method="POST" action="{% url "events.views.change_event_logo" event.id %}">
            {% csrf_token %}
            <div class="upload-file-button">
                {{ change_logo_form }}
            </div>
            <button type="submit">Save</button>
        </form>
    {% endif %}
    <div>
        <a href="{% url "events.views.edit_event" event.id %}">{% trans "Edit" %}</a>
        <a href="{% url "events.views.add_attraction" event.id %}">{% trans "Add attraction" %}</a>
    </div>

    <h1>{{ event.name }}</h1>
    {% if event.website %}
        <a href="{{ event.website }}">{{ event.website }}</a>
    {% endif %}
    <p>
        {{ event.start_date|default_if_none:'' }} 
        
        {% if event.end_date %}
            {% ifnotequal event.start_date event.end_date %}
                - {{ event.end_date }}
            {% endifnotequal %}
        {% endif %}
    </p>
    <p>
        {% if event.description %}
            {{ event.description }}
        {% endif %}
    </p>
    <dl> 
        <dt>{% trans "Organizer: " %}</dt>
        <dd>{{ event.organizer.name }}</dd>
        
        <dt>{% trans "Attractions: " %}</dt>
        <dd>
            {% for attraction in event.attraction_set.all %}
                <a href="{% url "events.views.attraction_details" event.id attraction.id %}">
                    {{ attraction }}
                </a>
                {% if not forloop.last %},{% endif %}
            {% empty %}
                {% trans "None :(" %}
            {% endfor %}
        </dd>

        <dt>{% trans "Category: " %}</dt>
        <dd>{{ event.category }}</dd>
    </dl>

    <form method='post' action='{% url "events.views.delete_event" event.id %}'>
        {% csrf_token %}
        <button type='submit' class='delete-button'>{% trans "Delete" %}</button>
    </form>
{% endblock %}
